<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Plataforma de Cursos Online</title>
    <!-- Vue.js CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Hoja principal de estilos (importa otras hojas) -->
    <link rel="stylesheet" href="css/main.css">
    <!-- Icono de la página -->
    <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon">
    <!-- Font Awesome CDN para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
</head>

<body>
    <div id="app">
        <!-- MENÚ SUPERIOR -->
        <header class="header">
            <div class="header-logo">{{ t.siteName }}</div>
            <nav class="header-nav">
                <a class="nav-link" href="#" @click.prevent="scrollTo('app')">{{ t.nav.home }}</a>
                <a class="nav-link" href="#" @click.prevent="scrollTo('catalog')">{{ t.nav.courses }}</a>
                <a class="nav-link" href="#">{{ t.nav.about }}</a>
                <a class="nav-link" href="#" @click.prevent="goTo('cart')">{{ t.nav.cart }}</a>

                <!-- SELECTOR DE PALETA DE COLORES -->
                <div class="palette-selector-container">
                    <button class="nav-link palette-toggle-btn" @click="togglePaletteSelector">{{ t.nav.theme
                        }}</button>
                    <div v-if="showPaletteSelector" class="palette-selector">
                        <div class="palette-grid">
                            <div v-for="key in paletteKeys" :key="key" class="palette-option"
                                @click="changePalette(key)" :class="{ active: selectedPalette === key }"
                                :title="getPaletteName(key)">
                                <div class="palette-preview">
                                    <div class="color-box"
                                        :style="{ backgroundColor: getPaletteColor(key, 'primary') }"></div>
                                    <div class="color-box"
                                        :style="{ backgroundColor: getPaletteColor(key, 'secondary') }"></div>
                                    <div class="color-box"
                                        :style="{ backgroundColor: getPaletteColor(key, 'background') }"></div>
                                </div>
                                <span class="palette-name">{{ getPaletteName(key) }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SELECTOR DE IDIOMA -->
                <div id="lang">
                    <div id="es" class="lang-option" :class="{ active: selectedLang === 'es' }"
                        @click="selectedLang = 'es'" data-lang="es">ES</div>
                    <div id="en" class="lang-option" :class="{ active: selectedLang === 'en' }"
                        @click="selectedLang = 'en'" data-lang="en">EN</div>
                </div>

                <!-- LOGIN / USUARIO -->
                <div class="palette-selector-container" v-if="isLoggedIn">
                    <button class="nav-link palette-toggle-btn user-name" @click="toggleUserMenu"
                        :title="sessionUser.nombre">
                        {{ sessionUser.nombre }}
                    </button>

                    <div v-if="showUserMenu" class="palette-selector user-dropdown-like">
                        <button class="user-dropdown-item" @click="logout">
                            <i class="fa-solid fa-right-from-bracket"></i>{{ t.nav.logout }}
                        </button>
                    </div>
                </div>

                <a v-else class="nav-link" href="#" @click.prevent="openLogin">{{ t.nav.login }}</a>
            </nav>
        </header>

        <!-- VISTA PRINCIPAL -->
        <div v-if="currentView === 'home'">
            <!-- CARRUSEL DE CURSOS DESTACADOS -->
            <section class="featured-courses-section">
                <h2 class="section-title">{{ t.featuredCourses }}</h2>
                <div class="carousel-container" @mouseenter="stopAutoSlide" @mouseleave="startAutoSlide">
                    <div class="carousel-track" :style="trackStyle">
                        <div v-for="(curso, index) in cursos" :key="curso.id" class="carousel-slide"
                            :class="getSlideClass(index)">
                            <div class="featured-course-card" @click="selectCourse(curso)">
                                    <div class="course-card-content">
                                        <div class="course-image-container">
                                            <img :src="curso.imagen" :alt="curso.titulo" class="course-image">
                                        </div>
                                        <div class="course-info-container">
                                            <h3 class="course-title">{{ curso.titulo }}</h3>
                                            <p class="course-description">{{ curso.descripcion }}</p>
                                            <span class="course-price">{{ curso.precio }}</span>
                                            <div class="course-meta-info">
                                                <span class="course-duration">
                                                    {{ curso.duracion }} ({{ Math.round(parseInt(curso.duracion) / 60) }} {{
                                                    t.hours }})
                                                </span>
                                                <div class="course-availability"
                                                    :class="{ 'available': curso.disponible, 'unavailable': !curso.disponible }">
                                                    {{ curso.disponible ? t.available : t.unavailable }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                <div class="carousel-controls">
                    <button class="carousel-btn prev-btn" @click="prevSlide"><i
                            class="fas fa-chevron-left"></i></button>
                    <div class="carousel-dots">
                        <div v-for="(curso, index) in cursos" :key="'dot-' + curso.id" class="carousel-dot"
                            :class="{ active: currentSlide === index }" @click="goToSlide(index)"></div>
                    </div>
                    <button class="carousel-btn next-btn" @click="nextSlide"><i
                            class="fas fa-chevron-right"></i></button>
                </div>
            </section>

            <!-- CATÁLOGO DE TODOS LOS CURSOS -->
            <main class="main-content" id="catalog">
                <div class="content-section">
                    <h1 class="page-title">{{ t.catalogTitle }}</h1>
                    <div class="courses-grid">
                        <div v-for="curso in cursos" :key="curso.id" class="course-card">
                            <img :src="curso.imagen" :alt="curso.titulo" class="course-thumbnail">
                            <div class="course-card-content">
                                <h3 class="course-title">{{ curso.titulo }}</h3>
                                <p class="course-description">{{ curso.descripcion }}</p>
                                <div class="course-card-footer">
                                    <span class="course-price">{{ curso.precio }}</span>
                                    <span class="course-duration">{{ Math.round(parseInt(curso.duracion) / 60)
                                        }}h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- VISTA DEL CARRITO DE COMPRAS -->
        <section v-else-if="currentView === 'cart'" class="cart-view main-content">
            <div class="content-section">
                <h1 class="page-title">{{ t.nav.cart }}</h1>
                <p>Aquí irá el contenido del carrito.</p>

            </div>
        </section>

        <!-- MODAL LOGIN / REGISTRO -->
        <div v-if="showAuthModal" class="auth-modal-overlay" @mousedown.self="closeAuth">
            <div class="auth-modal" @mousedown.stop>

                <div class="modal-header">
                    <h2 class="modal-title">{{ authMode === 'login' ? t.login.title : t.register.title }}</h2>
                    <button class="modal-close-btn" @click="closeAuth" aria-label="Cerrar">&times;</button>
                </div>

                <form @submit.prevent="submitAuth" class="auth-form">

                    <!-- CAMPOS SOLO PARA REGISTRO -->
                    <input v-if="authMode === 'register'" type="text" :placeholder="t.register.dni" v-model="auth.dni"
                        :class="inputClass('dni')" required title="DNI válido (8 números y una letra)">

                    <input v-if="authMode === 'register'" type="text" :placeholder="t.register.nombre"
                        v-model="auth.nombre" :class="inputClass('nombre')" required title="Solo letras y espacios">

                    <input type="text" :placeholder="t.register.email" v-model="auth.email" :class="inputClass('email')"
                        required title="Correo electrónico válido">

                    <input v-if="authMode === 'register'" type="text" :placeholder="t.register.telefono"
                        v-model="auth.telefono" :class="inputClass('telefono')" required title="Teléfono español">

                    <!-- CAMPOS DE CONTRASEÑA -->
                    <input type="password" :placeholder="t.login.password" v-model="auth.password"
                        :class="inputClass('password')" required>

                    <input v-if="authMode === 'register'" type="password" :placeholder="t.register.password2"
                        v-model="auth.password2" :class="inputClass('password2')" required>

                    <button type="submit" class="auth-submit-btn"
                        :disabled="authMode === 'register' && !isRegisterFormValid">
                        {{ authMode === 'login' ? t.login.loginButton : t.register.registerButton }}
                    </button>
                </form>

                <p class="auth-mode-switch">
                    <span v-if="authMode === 'login'">
                        {{ t.login.question }}
                        <a @click="authMode = 'register'">{{ t.register.registerButton }}</a>
                    </span>
                    <span v-else>
                        {{ t.register.question }}
                        <a @click="authMode = 'login'">{{ t.login.loginButton }}</a>
                    </span>
                </p>

            </div>
        </div>

        <!-- FOOTER -->
        <footer class="main-footer">
            <div class="footer-container">

                <div class="footer-column">
                    <h4>{{ t.siteName }}</h4>
                    <p>{{ t.footer.rights }}</p>
                </div>

                <div class="footer-column">
                    <h4>{{ t.nav.about }}</h4>
                    <ul>
                        <li><i class="fa-solid fa-location-dot"></i> {{ t.footer.address }}</li>
                        <li><i class="fa-solid fa-envelope"></i> {{ t.footer.email }}</li>
                        <li><i class="fa-solid fa-phone"></i> {{ t.footer.contact }}</li>
                    </ul>
                </div>

                <div class="footer-column footer-actions">
                    <span class="lang-indicator">
                        <i class="fa-solid fa-globe"></i>
                        {{ selectedLang === 'es' ? t.currentLangEs : t.currentLangEn }}
                    </span>

                    <button v-if="currentView !== 'cart'" class="back-to-top-btn" @click="scrollTo('app')">
                        <i class="fa-solid fa-arrow-up"></i> {{ t.footer.backToTop }}
                    </button>
                </div>
            </div>

            <div class="footer-bottom">
                © {{ new Date().getFullYear() }} · {{ t.siteName }}
            </div>
        </footer>
    </div>

    <!-- Cargar scripts en orden correcto -->
    <script src="js/i18n.js"></script>
    <script src="js/palettes.js"></script>
    <script src="js/app.js"></script>
</body>

</html>